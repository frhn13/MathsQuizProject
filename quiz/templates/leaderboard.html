{% extends "base.html" %}
{% block title %}Leaderboard{% endblock %}

{% block content %}
<div class="mt-5">
   <h1 class="text-center">Leaderboard</h1>
   <div class="text-center">
     {% if form %}
    <form method="POST" class="form-register mx-auto w-50 mt-5">
        {{ form.csrf_token() }}

        {{ form.number_or_percentage_returned.label() }}
        {% for button in form.number_or_percentage_returned %}
        <br>
            {{ button.label() }}
            {{ button() }}
        {% endfor %}
        <br>
        <br>
        {{ form.results_returned.label() }}
        {% for button in form.results_returned %}
        <br>
            {{ button.label() }}
            {{ button(onchange="toggleFormFields()")}}
        {% endfor %}
        <br>
        <br>
        <div id="topicField">
            {{ form.topic_chosen.label() }}
            {{ form.topic_chosen(class="form-control") }}
        </div>
        <div id="difficultyField">
            {{ form.difficulty_chosen.label() }}
            {{ form.difficulty_chosen(class="form-control") }}
        </div>
        <br>
        {{ form.submit(class="btn btn-primary btn-lg mt-5") }}
    </form>
  {% endif %}
  </div>
   </div>
  {% if form_is_submitted %}
    <ol>
      {% for user in user_results %}
      <li>
        <ul>
          <li>Username: {{ user[0] }}</li>
          <li>Correct Answers: {{ user[1] }}</li>
          <li>Incorrect Answers: {{ user[2] }}</li>
          <li>Percentage of Correct Answers: {{ user[3] }}%</li>
        </ul>
      </li>
      <br>
     {% endfor %}
    </ol>
  {% endif %}
</div>

<script>
        function toggleFormFields() {
            let selectedValue = document.querySelector('input[name="results_returned"]:checked').value;

            let topicField = document.getElementById("topicField");
            let difficultyField = document.getElementById("difficultyField");

            if (selectedValue == "all") {
                topicField.style.display = "none";
                difficultyField.style.display = "none";
            } else if (selectedValue == "difficulty") {
                topicField.style.display = "none";
                difficultyField.style.display = "block";
            } else {
                topicField.style.display = "block";
                difficultyField.style.display = "none";
            }
        }
        document.addEventListener("DOMContentLoaded", toggleFormFields);
</script>
{% endblock %}